{% extends "base.html" %}
{% block title %}Events — RaceTrace{% endblock %}
{% block content %}
<div class="page-header">
  <h1>Events</h1>
  <a href="#" class="btn btn-primary" id="create-btn" style="display:none">+ Create Event</a>
</div>
<div id="events-container"><p>Loading…</p></div>
{% endblock %}
{% block scripts %}
<script>
if (localStorage.getItem("access_token")) document.getElementById("create-btn").style.display="";
fetch("/api/v1/events/").then(r=>r.json()).then(events => {
  const el = document.getElementById("events-container");
  if (!events.length) { el.innerHTML="<p>No upcoming events. Be the first to create one!</p>"; return; }
  el.innerHTML = events.map(e => `
    <div class="session-card">
      <h3><a href="/events/${e.id}">${e.name}</a> <span class="badge badge-${e.status}">${e.status}</span></h3>
      <p class="muted">${new Date(e.date_start).toLocaleDateString()} · ${e.participant_count} participants · ${e.is_open ? "Open" : "Invite only"}</p>
    </div>
  `).join("");
});
</script>
{% endblock %}
